<launch>
  <arg name="map" value="icra2019"/>
  <master auto="restart"/>


  
  <node name="map_server" pkg="map_server" type="map_server" args="$(find icra_roboin_navigation)/maps/$(arg map).yaml" respawn="false">
  	<param name="frame_id" value="map"/>
  </node>


   <include file="$(find icra_roboin_bringup)/launch/base.launch" />

    <node pkg="tf2_ros" type="static_transform_publisher" name="base_link_base_laser_link_broadcaster"
          args="0.17 0.0 0.05 3.1415 0.0 0 base_link base_laser_link" />

    <node pkg="tf2_ros" type="static_transform_publisher" name="base_link_camera_link_broadcaster"
          args="0.0  0.0 0.0  0.0  0.0 0.0 base_link camera" />

  <node pkg="lidar_detector" type="lidar_filter_node" name="lidar_filter_node"/>


  <node name="rplidar_node" pkg="rplidar_ros" type="rplidarNode" output="screen">
      <param name="serial_port" type="string" value="/dev/rplidar"/>
      <param name="serial_baudrate" type="int" value="115200"/>
      <param name="frame_id" type="string" value="base_laser_link"/>
      <param name="inverted" type="bool" value="false"/>
      <param name="angle_compensate" type="bool" value="true"/>
      <remap from="scan" to="scan_before"/>
  </node>





  
  <include file="$(find icra_roboin_navigation)/launch/amcl.launch">

  	<arg name="odom_frame_id"     value="odom"/>
        <arg name="base_frame_id"     value="base_link"/>
  	<arg name="global_frame_id"     value="map"/>

  	<arg name="scan_topic_name"     value="scan"/>
  	<arg name="map_topic_name"     value="map"/>

  	<arg name="initial_pose_x" value="1"/>
  	<arg name="initial_pose_y" value="1"/>
  	<arg name="initial_pose_a" value="0"/>

  </include> 


  <include file="$(find icra_roboin_navigation)/launch/navigation_base.launch">

  	<arg name="cmd_vel_topic" default="cmd_vel" />
  	<arg name="local_planner_algorithm" default="dwa_local_planner/DWAPlannerROS"/>

  </include>


  <node pkg="icra_roboin_behavior" type="behavior_node" name="behavior_node" respawn="false" output="screen">
  	<param name="team" value="red_team"/>
  	<param name="rule" value="1vs1"/>
  </node>

  <!-- rviz -->
  <node name="rviz" pkg="rviz" type="rviz" args="-d $(find icra_roboin_bringup)/rviz/yonsei1.rviz" />






</launch>
