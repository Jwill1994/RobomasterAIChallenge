<launch>
  <master auto="start"/>
  <arg name="map" value="icra2019"/>

  <!-- Run the robot sdk interface -->
  <include file="$(find roborts_bringup)/launch/base.launch" />


  <!-- Run the map server -->
  <node name="map_server" pkg="map_server" type="map_server" args="$(find roborts_bringup)/maps/$(arg map).yaml" respawn="false" />

  <!--static_transform_publisher x y z yaw pitch roll frame_id child_frame_id-->
    <node pkg="tf2_ros" type="static_transform_publisher" name="base_link_base_laser_link_broadcaster"
          args="0.15 0.0 0.05 3.1415 0.0 0 base_link base_laser_link" />

    <node pkg="tf2_ros" type="static_transform_publisher" name="base_link_camera_link_broadcaster"
          args="0.0  0.0 0.0  0.0  0.0 0.0 base_link camera" />

  <node pkg="laser_filters" type="scan_to_scan_filter_chain"
      name="laser_filter">
    <rosparam command="load" file="$(find laser_filters)/my_laser_config.yaml" />
  </node>


  <node name="rplidar_node" pkg="rplidar_ros" type="rplidarNode" output="screen">
      <param name="serial_port" type="string" value="/dev/rplidar"/>
      <param name="serial_baudrate" type="int" value="115200"/>
      <param name="frame_id" type="string" value="base_laser_link"/>
      <param name="inverted" type="bool" value="false"/>
      <param name="angle_compensate" type="bool" value="true"/>
      <remap from="scan" to="scan_before"/>
  </node>

<!-- amcl -->
  <include file="$(find icra_roboin_navigation)/launch/amcl.launch">

  	<arg name="odom_frame_id"     default="odom"/>
  	<arg name="base_frame_id"     default="base_link"/>
  	<arg name="global_frame_id"     default="map"/>

  	<arg name="scan_topic_name"     default="scan"/>
  	<arg name="map_topic_name"     default="map"/>

  	<arg name="initial_pose_x" default="1"/>
  	<arg name="initial_pose_y" default="1"/>
  	<arg name="initial_pose_a" default="0"/>

  </include>


  <include file="$(find icra_roboin_navigation)/launch/navigation_base.launch">

  	<arg name="cmd_vel_topic" default="cmd_vel" />
  	<arg name="local_planner_algorithm" default="dwa_local_planner/DWAPlannerROS"/>

  </include>

</launch>

